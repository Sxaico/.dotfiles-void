#!/bin/sh
set -eu
APPS="$HOME/Applications"
DESKDIR="$HOME/.local/share/applications"
ICODIR="$HOME/.local/share/icons/appimages"

set -- "$APPS"/*.AppImage
[ -e "$1" ] || exit 0

SEL="$(printf '%s\n' "$@" | sed 's|.*/||' | bemenu -i -p 'Eliminar AppImage' || true)"
[ -z "${SEL:-}" ] && exit 0

APP="$APPS/$SEL"
DESK="$DESKDIR/${SEL}.desktop"
ICON="$ICODIR/${SEL}.png"

ANS="$(printf '%s\n' 'No' 'Sí' | bemenu -i -p "Eliminar $SEL ?")"
[ "$ANS" != "Sí" ] && exit 0

rm -f "$APP" "$DESK" "$ICON"
command -v update-desktop-database >/dev/null 2>&1 && update-desktop-database "$DESKDIR" >/dev/null 2>&1 || true
command -v notify-send >/dev/null 2>&1 && notify-send "AppImage" "Eliminado: $SEL"

